{"level":"error","message":"res.writeHead is not a function","metadata":{"stack":"TypeError: res.writeHead is not a function\n    at sendJSON (/Users/user/Downloads/rrhh-minoil/wsbot/src/utils/response.ts:8:7)\n    at sendSuccess (/Users/user/Downloads/rrhh-minoil/wsbot/src/utils/response.ts:21:11)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/urlStats.ts:10:14\n    at Generator.next (<anonymous>)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/urlStats.ts:8:71\n    at new Promise (<anonymous>)\n    at __awaiter (/Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/urlStats.ts:4:12)\n    at handler (/Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/urlStats.ts:7:46)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/utils/response.ts:97:13\n    at Generator.next (<anonymous>)","statusCode":500,"timestamp":"2025-10-13 16:09:18"}}
{"level":"error","message":"Error al procesar boleta en flow","metadata":{"error":"Request failed with status code 404","flow":"getMonths","month":"202509","phone":"59177757416","stack":"AxiosError: Request failed with status code 404\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:531:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-22 07:22:18"}}
{"level":"error","message":"Error en API externa","metadata":{"error":{"code":"ECONNREFUSED","config":{"adapter":["xhr","http","fetch"],"env":{},"headers":{"Accept":"application/json, text/plain, */*","Accept-Encoding":"gzip, compress, deflate, br","User-Agent":"axios/1.7.7"},"maxBodyLength":-1,"maxContentLength":-1,"method":"get","timeout":0,"transformRequest":[null],"transformResponse":[null],"transitional":{"clarifyTimeoutError":false,"forcedJSONParsing":true,"silentJSONParsing":true},"url":"http://localhost/user/665","xsrfCookieName":"XSRF-TOKEN","xsrfHeaderName":"X-XSRF-TOKEN"},"message":"","name":"AggregateError","stack":"AggregateError\n    at Function.AxiosError.from (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/AxiosError.js:92:14)\n    at RedirectableRequest.handleRequestError (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:620:25)\n    at RedirectableRequest.emit (node:events:507:28)\n    at RedirectableRequest.emit (node:domain:489:12)\n    at ClientRequest.eventHandlers.<computed> (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/follow-redirects/index.js:49:24)\n    at ClientRequest.emit (node:events:507:28)\n    at ClientRequest.emit (node:domain:489:12)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:518:5)\n    at Socket.emit (node:events:507:28)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"},"stack":"AggregateError\n    at Function.AxiosError.from (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/AxiosError.js:92:14)\n    at RedirectableRequest.handleRequestError (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:620:25)\n    at RedirectableRequest.emit (node:events:507:28)\n    at RedirectableRequest.emit (node:domain:489:12)\n    at ClientRequest.eventHandlers.<computed> (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/follow-redirects/index.js:49:24)\n    at ClientRequest.emit (node:events:507:28)\n    at ClientRequest.emit (node:domain:489:12)\n    at emitErrorEvent (node:_http_client:104:11)\n    at Socket.socketErrorListener (node:_http_client:518:5)\n    at Socket.emit (node:events:507:28)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 16:02:46","url":"http://localhost"}}
{"level":"error","message":"Error en API externa","metadata":{"error":"Request failed with status code 500","stack":"AxiosError: Request failed with status code 500\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:519:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:19:37","url":"http://190.171.225.68/api/vacaciones/add-vacation"}}
{"level":"error","message":"Error en POST /api/save-vacation-to-external","metadata":{"error":"Error al guardar vacación en la API externa","stack":"ExternalAPIError: Error al guardar vacación en la API externa\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:64:11\n    at Generator.throw (<anonymous>)\n    at rejected (/Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:6:65)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:19:37"}}
{"level":"error","message":"Error en API externa","metadata":{"error":"Request failed with status code 500","stack":"AxiosError: Request failed with status code 500\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:519:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:21:27","url":"http://190.171.225.68/api/vacaciones/add-vacation"}}
{"level":"error","message":"Error en POST /api/save-vacation-to-external","metadata":{"error":"Error al guardar vacación en la API externa","stack":"ExternalAPIError: Error al guardar vacación en la API externa\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:64:11\n    at Generator.throw (<anonymous>)\n    at rejected (/Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:6:65)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:21:27"}}
{"level":"error","message":"Error en API externa","metadata":{"error":"Request failed with status code 500","stack":"AxiosError: Request failed with status code 500\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:519:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:25:17","url":"http://190.171.225.68/api/vacaciones/add-vacation"}}
{"level":"error","message":"Error en POST /api/save-vacation-to-external","metadata":{"error":"Error al guardar vacación en la API externa","stack":"ExternalAPIError: Error al guardar vacación en la API externa\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:64:11\n    at Generator.throw (<anonymous>)\n    at rejected (/Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:6:65)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:25:17"}}
{"level":"error","message":"Error en API externa","metadata":{"error":"Request failed with status code 500","stack":"AxiosError: Request failed with status code 500\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:519:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:26:04","url":"http://190.171.225.68/api/vacaciones/add-vacation"}}
{"level":"error","message":"Error en POST /api/save-vacation-to-external","metadata":{"error":"Error al guardar vacación en la API externa","stack":"ExternalAPIError: Error al guardar vacación en la API externa\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:65:11\n    at Generator.throw (<anonymous>)\n    at rejected (/Users/user/Downloads/rrhh-minoil/wsbot/src/services/saveVacationToAPI.ts:6:65)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-23 17:26:04"}}
{"level":"error","message":"❌ Error al enviar PDF de solicitud","metadata":{"emp_id":"665","error":"protocol mismatch","solicitud_id":"27","timestamp":"2025-10-24 09:17:17"}}
{"level":"error","message":"❌ Error al obtener datos de solicitud: ENOENT: no such file or directory, scandir '/Users/user/Downloads/rrhh-minoil/wsbot/src/logs'","metadata":{"code":"ENOENT","errno":-2,"path":"/Users/user/Downloads/rrhh-minoil/wsbot/src/logs","stack":"Error: ENOENT: no such file or directory, scandir '/Users/user/Downloads/rrhh-minoil/wsbot/src/logs'\n    at Object.readdirSync (node:fs:1581:26)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/getVacationData.ts:26:25\n    at Generator.next (<anonymous>)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/getVacationData.ts:8:71\n    at new Promise (<anonymous>)\n    at __awaiter (/Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/getVacationData.ts:4:12)\n    at handleGetVacationData (/Users/user/Downloads/rrhh-minoil/wsbot/src/handlers/getVacationData.ts:11:70)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/utils/response.ts:97:13\n    at Generator.next (<anonymous>)\n    at /Users/user/Downloads/rrhh-minoil/wsbot/src/utils/response.ts:8:71","syscall":"scandir","timestamp":"2025-10-24 10:42:59"}}
{"level":"error","message":"Error al procesar boleta en flow","metadata":{"error":"Request failed with status code 404","flow":"getMonths","month":"202509","phone":"59177915021","stack":"AxiosError: Request failed with status code 404\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:599:11)\n    at IncomingMessage.emit (node:events:519:35)\n    at IncomingMessage.emit (node:domain:489:12)\n    at endReadableNT (node:internal/streams/readable:1696:12)\n    at processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-10-24 13:16:56"}}
{"level":"error","message":"Error al procesar boleta en flow","metadata":{"error":"Request failed with status code 500","flow":"getMonths","month":"202510","phone":"74539476230262@lid","stack":"AxiosError: Request failed with status code 500\n    at settle (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/settle.js:19:12)\n    at IncomingMessage.handleStreamEnd (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/adapters/http.js:793:11)\n    at IncomingMessage.emit (node:events:531:35)\n    at endReadableNT (node:internal/streams/readable:1698:12)\n    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)\n    at Axios.request (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/axios/lib/core/Axios.js:45:41)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at async Object.ans_c8e3a1e1-d88e-43c2-b6a2-636fcfb5581d (/Users/user/Downloads/rrhh-minoil/wsbot/src/flows/getMonthsFlow.ts:98:33)\n    at async runContext (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/@builderbot/bot/dist/index.cjs:14528:25)\n    at async cbEveryCtx (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/@builderbot/bot/dist/index.cjs:14559:17)\n    at async sendFlow (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/@builderbot/bot/dist/index.cjs:14306:21)\n    at async exportFunctionsSend (/Users/user/Downloads/rrhh-minoil/wsbot/node_modules/@builderbot/bot/dist/index.cjs:14563:17)","timestamp":"2025-11-11 12:00:57"}}
